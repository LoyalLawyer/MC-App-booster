<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Find Your Firm ‚Äî MagicCircleHub</title>
<link rel="stylesheet" href="style.css">
<style>
.match-hero {
  background: var(--ink); color: white;
  padding: 48px; margin-bottom: 32px;
  position: relative; overflow: hidden;
}
.match-hero::after {
  content: '?'; position: absolute;
  right: 48px; top: 50%; transform: translateY(-50%);
  font-family: 'Frank Ruhl Libre', serif;
  font-size: 180px; font-weight: 900;
  opacity: 0.04; color: white; line-height: 1;
  pointer-events: none;
}
.match-hero h1 {
  font-family: 'Frank Ruhl Libre', serif;
  font-size: 38px; font-weight: 900; line-height: 1.15; margin-bottom: 12px;
}
.match-hero h1 span { color: #c8973a; }
.match-hero p { font-size: 14px; color: #aaa; line-height: 1.7; max-width: 520px; }
.hero-pills { display: flex; gap: 8px; margin-top: 20px; flex-wrap: wrap; }
.hero-pill { padding: 4px 14px; border: 1px solid #333; font-size: 11.5px; color: #777; }

/* Progress */
.progress-bar {
  background: var(--white); border: 1px solid var(--border);
  padding: 16px 24px; margin-bottom: 24px;
  display: flex; align-items: center; gap: 16px;
}
.progress-track { flex: 1; height: 4px; background: var(--faint); border: 1px solid var(--border); }
.progress-fill { height: 100%; background: var(--ink); transition: width .4s ease; }
.progress-label { font-size: 12px; color: var(--muted); white-space: nowrap; }
.progress-num { font-size: 12px; font-weight: 700; color: var(--ink); white-space: nowrap; min-width: 48px; text-align: right; }

/* Form */
.q-card {
  background: var(--white); border: 1px solid var(--border);
  padding: 36px 40px; display: none;
  animation: fadeIn .3s ease;
}
.q-card.active { display: block; }
@keyframes fadeIn { from { opacity:0; transform:translateY(8px); } to { opacity:1; transform:translateY(0); } }

.q-number { font-size: 10.5px; letter-spacing: 3px; text-transform: uppercase; color: var(--muted); margin-bottom: 8px; }
.q-text {
  font-family: 'Frank Ruhl Libre', serif;
  font-size: 22px; font-weight: 700; line-height: 1.3;
  margin-bottom: 6px; color: var(--ink);
}
.q-sub { font-size: 13px; color: var(--muted); margin-bottom: 28px; line-height: 1.5; }

/* Options */
.options-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
.options-grid.single-col { grid-template-columns: 1fr; }
.option {
  padding: 14px 18px; border: 1.5px solid var(--border);
  cursor: pointer; transition: all .15s; background: var(--bg);
  display: flex; align-items: flex-start; gap: 12px;
}
.option:hover { border-color: var(--ink); background: var(--white); }
.option.selected { border-color: var(--ink); background: var(--ink); color: white; }
.option-letter {
  width: 22px; height: 22px; border-radius: 50%;
  border: 1.5px solid currentColor;
  display: flex; align-items: center; justify-content: center;
  font-size: 10px; font-weight: 700; flex-shrink: 0; margin-top: 1px;
}
.option-selected-check { display: none; }
.option.selected .option-selected-check { display: block; }
.option.selected .option-letter { display: none; }
.option-content {}
.option-title { font-size: 13.5px; font-weight: 600; line-height: 1.3; margin-bottom: 2px; }
.option-desc { font-size: 12px; opacity: .75; line-height: 1.4; }

/* Multi select tags */
.tag-grid { display: flex; flex-wrap: wrap; gap: 8px; }
.tag-select {
  padding: 7px 16px; border: 1.5px solid var(--border);
  font-size: 12.5px; cursor: pointer; background: var(--bg);
  transition: all .12s; color: var(--muted);
}
.tag-select:hover { border-color: var(--ink); color: var(--ink); }
.tag-select.selected { background: var(--ink); color: white; border-color: var(--ink); }

/* Text input */
.q-input {
  width: 100%; padding: 14px 16px;
  background: var(--bg); border: 1.5px solid var(--border);
  font-family: 'DM Sans', sans-serif; font-size: 14px;
  color: var(--ink); outline: none; transition: border-color .2s;
}
.q-input:focus { border-color: var(--ink); }
.q-input::placeholder { color: #bbb; }
textarea.q-input { resize: vertical; min-height: 100px; line-height: 1.6; }

/* Spectrum slider */
.spectrum {
  margin: 8px 0 4px;
}
.spectrum-labels {
  display: flex; justify-content: space-between;
  font-size: 11.5px; color: var(--muted); margin-bottom: 10px;
}
.spectrum-labels span { max-width: 40%; line-height: 1.3; }
.spectrum-labels span:last-child { text-align: right; }
input[type="range"] {
  width: 100%; height: 4px; padding: 0; margin: 0;
  background: var(--border); border: none;
  accent-color: var(--ink); cursor: pointer;
}
.spectrum-value {
  text-align: center; margin-top: 8px;
  font-size: 12px; color: var(--muted);
  min-height: 18px; font-style: italic;
}

/* Nav */
.q-nav {
  display: flex; justify-content: space-between; align-items: center;
  margin-top: 32px; padding-top: 20px; border-top: 1px solid var(--border);
}
.btn-back {
  padding: 10px 22px; background: transparent;
  border: 1.5px solid var(--border); color: var(--muted);
  font-family: 'DM Sans', sans-serif; font-size: 13px; font-weight: 500;
  cursor: pointer; transition: all .15s;
}
.btn-back:hover { border-color: var(--ink); color: var(--ink); }
.btn-next {
  padding: 11px 28px; background: var(--ink);
  border: none; color: white;
  font-family: 'DM Sans', sans-serif; font-size: 13.5px; font-weight: 600;
  cursor: pointer; transition: background .15s;
}
.btn-next:hover { background: #333; }
.btn-next:disabled { background: var(--border); color: var(--muted); cursor: not-allowed; }
.btn-match {
  padding: 12px 36px; background: var(--fresh); border: none; color: white;
  font-family: 'DM Sans', sans-serif; font-size: 14px; font-weight: 700;
  cursor: pointer; transition: background .15s; letter-spacing: 0.3px;
}
.btn-match:hover { background: #7a1414; }
.btn-match:disabled { background: var(--border); color: var(--muted); cursor: not-allowed; }

/* Loading */
.loading-screen {
  display: none; background: var(--white); border: 1px solid var(--border);
  padding: 60px 40px; text-align: center;
}
.spinner {
  width: 44px; height: 44px; border: 3px solid var(--border);
  border-top-color: var(--ink); border-radius: 50%;
  animation: spin .8s linear infinite; margin: 0 auto 24px;
}
@keyframes spin { to { transform: rotate(360deg); } }
.loading-title {
  font-family: 'Frank Ruhl Libre', serif;
  font-size: 22px; font-weight: 700; margin-bottom: 8px;
}
.loading-sub { font-size: 13px; color: var(--muted); margin-bottom: 32px; }
.loading-steps { max-width: 300px; margin: 0 auto; }
.lstep {
  display: flex; align-items: center; gap: 12px;
  padding: 9px 0; border-bottom: 1px solid var(--faint);
  font-size: 13px; color: var(--muted); text-align: left;
}
.lstep:last-child { border-bottom: none; }
.lstep-dot {
  width: 8px; height: 8px; border-radius: 50%;
  background: var(--border); flex-shrink: 0; transition: background .3s;
}
.lstep.active .lstep-dot { background: var(--ink); animation: pulse 1s infinite; }
.lstep.done .lstep-dot { background: #1a7a1a; }
.lstep.done { color: var(--ink); }
@keyframes pulse { 0%,100%{opacity:1} 50%{opacity:.3} }

/* Results */
.results-screen { display: none; }

.result-hero {
  padding: 32px 36px; margin-bottom: 16px;
  display: flex; align-items: center; justify-content: space-between; gap: 24px;
  flex-wrap: wrap;
}
.result-hero-left {}
.result-badge {
  font-size: 10px; font-weight: 700; letter-spacing: 2px;
  text-transform: uppercase; color: rgba(255,255,255,.7);
  background: rgba(255,255,255,.12); padding: 4px 12px;
  display: inline-block; margin-bottom: 12px;
}
.result-firm-name {
  font-family: 'Frank Ruhl Libre', serif;
  font-size: 34px; font-weight: 900; color: white; line-height: 1.1; margin-bottom: 6px;
}
.result-tagline { font-size: 14px; color: rgba(255,255,255,.75); line-height: 1.5; max-width: 420px; }
.result-score-circle {
  text-align: center; background: rgba(255,255,255,.1);
  padding: 20px 28px; flex-shrink: 0;
}
.result-score-num {
  font-family: 'Frank Ruhl Libre', serif;
  font-size: 52px; font-weight: 900; color: white; line-height: 1;
}
.result-score-label { font-size: 11px; color: rgba(255,255,255,.6); letter-spacing: 1px; margin-top: 4px; }

.result-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px; }
.result-box { background: var(--white); border: 1px solid var(--border); padding: 22px 24px; }
.result-box.full { grid-column: 1 / -1; }
.result-box-title {
  font-family: 'Frank Ruhl Libre', serif;
  font-size: 15px; font-weight: 700;
  margin-bottom: 14px; padding-bottom: 10px;
  border-bottom: 1px solid var(--border);
}
.result-text { font-size: 13.5px; color: #333; line-height: 1.78; }
.result-text ul { padding-left: 18px; margin-top: 8px; }
.result-text ul li { margin-bottom: 7px; }
.result-text a { color: var(--fresh); border-bottom: 1px solid; }

.dim-row { display: flex; align-items: center; gap: 10px; margin-bottom: 9px; }
.dim-label { font-size: 12px; color: var(--muted); width: 110px; flex-shrink: 0; }
.dim-track { flex: 1; height: 5px; background: var(--faint); border: 1px solid var(--border); }
.dim-fill { height: 100%; transition: width 1s cubic-bezier(.16,1,.3,1); width: 0; }
.dim-val { font-size: 12px; font-weight: 700; width: 32px; text-align: right; }

.cover-letter-box {
  background: var(--faint); border-left: 3px solid var(--ink);
  padding: 16px 18px; font-size: 13.5px; line-height: 1.75; color: #333;
}

.other-list { display: flex; flex-direction: column; gap: 2px; margin-bottom: 12px; }
.other-row {
  background: var(--white); border: 1px solid var(--border);
  padding: 12px 18px; display: flex; align-items: center; gap: 14px;
  cursor: pointer; transition: background .1s;
}
.other-row:hover { background: var(--faint); }
.other-dot { width: 10px; height: 10px; border-radius: 50%; flex-shrink: 0; }
.other-name { font-size: 13.5px; font-weight: 600; flex: 1; }
.other-track { width: 80px; height: 4px; background: var(--faint); border: 1px solid var(--border); }
.other-fill { height: 100%; }
.other-pct { font-size: 13px; font-weight: 700; min-width: 36px; text-align: right; }

.sources-box {
  background: var(--faint); border: 1px solid var(--border);
  padding: 14px 18px; margin-top: 12px;
  font-size: 11.5px; color: var(--muted);
}
.sources-box a { color: var(--fresh); }

.action-row { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 20px; }
.btn-action {
  padding: 11px 22px; font-size: 13px; font-weight: 600;
  font-family: 'DM Sans', sans-serif; cursor: pointer; transition: all .15s;
}
.btn-primary-action { background: var(--ink); color: white; border: none; }
.btn-primary-action:hover { background: #333; }
.btn-ghost-action { background: transparent; border: 1.5px solid var(--border); color: var(--ink); }
.btn-ghost-action:hover { border-color: var(--ink); }

@media(max-width:700px){
  .result-grid{grid-template-columns:1fr;}
  .options-grid{grid-template-columns:1fr;}
  .result-hero{flex-direction:column;}
  .q-card{padding:24px 20px;}
  .match-hero{padding:28px 20px;}
}
</style>
</head>
<body>
<div id="shell"></div>

<div class="page">

<div class="match-hero">
  <div style="font-size:10.5px;letter-spacing:3px;text-transform:uppercase;color:#666;margin-bottom:12px;">AI Firm Matcher</div>
  <h1>Which Magic Circle Firm<br>is <span>Actually</span> Right for You?</h1>
  <p>Answer 12 honest questions about how you think, what drives you and what you want from your career. Our AI matches you to the right firm ‚Äî and finds real cases they've worked on that align with your interests.</p>
  <div class="hero-pills">
    <span class="hero-pill">üîç Searches real cases</span>
    <span class="hero-pill">üß† Psychological profiling</span>
    <span class="hero-pill">üìÑ Cover letter angle</span>
    <span class="hero-pill">üÜì Free</span>
  </div>
</div>

<!-- PROGRESS -->
<div class="progress-bar" id="progressBar">
  <span class="progress-label">Question</span>
  <div class="progress-track"><div class="progress-fill" id="progressFill" style="width:8%"></div></div>
  <span class="progress-num" id="progressNum">1 / 12</span>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     QUESTIONS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->

<!-- Q1: Study -->
<div class="q-card active" id="q0">
  <div class="q-number">Question 1 of 12 ‚Äî Background</div>
  <div class="q-text">What are you studying and where?</div>
  <div class="q-sub">This helps us understand your starting point ‚Äî both matter to different firms.</div>
  <input type="text" class="q-input" id="a0" placeholder="e.g. Law LLB, University of Bristol, 2nd year ‚Äî or Economics at LSE, final year">
  <div class="q-nav">
    <span></span>
    <button class="btn-next" onclick="next(0)">Next ‚Üí</button>
  </div>
</div>

<!-- Q2: Scenario ‚Äî how you think -->
<div class="q-card" id="q1">
  <div class="q-number">Question 2 of 12 ‚Äî How You Think</div>
  <div class="q-text">A client calls you at 11pm. They've just received a hostile takeover bid and need advice on how to respond. What's your instinct?</div>
  <div class="q-sub">There's no right answer ‚Äî we're looking at how your mind works under pressure.</div>
  <div class="options-grid" id="a1">
    <div class="option" onclick="selectOption('a1', this, 'A')">
      <div class="option-letter">A</div>
      <div class="option-selected-check">‚úì</div>
      <div class="option-content">
        <div class="option-title">Analyse the documents first</div>
        <div class="option-desc">I want to read the bid before saying anything. The details are everything.</div>
      </div>
    </div>
    <div class="option" onclick="selectOption('a1', this, 'B')">
      <div class="option-letter">B</div>
      <div class="option-selected-check">‚úì</div>
      <div class="option-content">
        <div class="option-title">Ask about the bigger picture</div>
        <div class="option-desc">I need to understand the client's strategy, shareholders and what outcome they actually want.</div>
      </div>
    </div>
    <div class="option" onclick="selectOption('a1', this, 'C')">
      <div class="option-letter">C</div>
      <div class="option-selected-check">‚úì</div>
      <div class="option-content">
        <div class="option-title">Think about the regulatory angle</div>
        <div class="option-desc">My first thought is whether there are competition or regulatory issues that could block or complicate the bid.</div>
      </div>
    </div>
    <div class="option" onclick="selectOption('a1', this, 'D')">
      <div class="option-letter">D</div>
      <div class="option-selected-check">‚úì</div>
      <div class="option-content">
        <div class="option-title">Call the senior partner immediately</div>
        <div class="option-desc">This is a team effort ‚Äî I want the right people involved from the start.</div>
      </div>
    </div>
  </div>
  <div class="q-nav">
    <button class="btn-back" onclick="prev(1)">‚Üê Back</button>
    <button class="btn-next" onclick="next(1)">Next ‚Üí</button>
  </div>
</div>

<!-- Q3: Practice interest ‚Äî deeper -->
<div class="q-card" id="q2">
  <div class="q-number">Question 3 of 12 ‚Äî What Excites You</div>
  <div class="q-text">Which of these headlines would make you stop scrolling and read the full article?</div>
  <div class="q-sub">Pick the one that genuinely pulls you in most.</div>
  <div class="options-grid single-col" id="a2">
    <div class="option" onclick="selectOption('a2', this, 'mega_ma')">
      <div class="option-letter">A</div><div class="option-selected-check">‚úì</div>
      <div class="option-content">
        <div class="option-title">"$50B Merger Blocked ‚Äî Regulator Finds Competition Risk in 14 Countries"</div>
        <div class="option-desc">The intersection of M&A strategy and antitrust law across borders</div>
      </div>
    </div>
    <div class="option" onclick="selectOption('a2', this, 'sovereign_debt')">
      <div class="option-letter">B</div><div class="option-selected-check">‚úì</div>
      <div class="option-content">
        <div class="option-title">"Egypt Returns to Bond Markets Raising $2B ‚Äî Why It Matters for Emerging Economies"</div>
        <div class="option-desc">Capital markets, sovereign finance, geopolitics</div>
      </div>
    </div>
    <div class="option" onclick="selectOption('a2', this, 'pe_lbo')">
      <div class="option-letter">C</div><div class="option-selected-check">‚úì</div>
      <div class="option-content">
        <div class="option-title">"Private Equity Giant Completes ¬£8B Leveraged Buyout of UK Tech Firm"</div>
        <div class="option-desc">PE deal structure, LBO mechanics, sponsor-side advisory</div>
      </div>
    </div>
    <div class="option" onclick="selectOption('a2', this, 'arbitration')">
      <div class="option-letter">D</div><div class="option-selected-check">‚úì</div>
      <div class="option-content">
        <div class="option-title">"State Ordered to Pay $1.2B ‚Äî Landmark Investment Treaty Arbitration Award"</div>
        <div class="option-desc">International disputes, arbitration, state liability</div>
      </div>
    </div>
    <div class="option" onclick="selectOption('a2', this, 'finreg')">
      <div class="option-letter">E</div><div class="option-selected-check">‚úì</div>
      <div class="option-content">
        <div class="option-title">"New AI Act Compliance Rules Force Banks to Overhaul Risk Models"</div>
        <div class="option-desc">Financial regulation, tech law, systemic change</div>
      </div>
    </div>
  </div>
  <div class="q-nav">
    <button class="btn-back" onclick="prev(2)">‚Üê Back</button>
    <button class="btn-next" onclick="next(2)">Next ‚Üí</button>
  </div>
</div>

<!-- Q4: Trade-off -->
<div class="q-card" id="q3">
  <div class="q-number">Question 4 of 12 ‚Äî Career Trade-offs</div>
  <div class="q-text">You can only pick one. Which matters more to you right now?</div>
  <div class="q-sub">Be honest ‚Äî there's no prestigious answer here.</div>
  <div class="options-grid" id="a3">
    <div class="option" onclick="selectOption('a3', this, 'quality_over_money')">
      <div class="option-letter">A</div><div class="option-selected-check">‚úì</div>
      <div class="option-content">
        <div class="option-title">Working on the most complex, high-stakes deals</div>
        <div class="option-desc">Even if the hours are brutal and pay is slightly less</div>
      </div>
    </div>
    <div class="option" onclick="selectOption('a3', this, 'money_over_balance')">
      <div class="option-letter">B</div><div class="option-selected-check">‚úì</div>
      <div class="option-content">
        <div class="option-title">Maximum earning potential</div>
        <div class="option-desc">I want to be paid what the market will bear for my skills</div>
      </div>
    </div>
    <div class="option" onclick="selectOption('a3', this, 'balance_over_prestige')">
      <div class="option-letter">C</div><div class="option-selected-check">‚úì</div>
      <div class="option-content">
        <div class="option-title">A sustainable lifestyle alongside a great career</div>
        <div class="option-desc">Top-quality work, but not at the cost of everything else</div>
      </div>
    </div>
    <div class="option" onclick="selectOption('a3', this, 'global_over_uk')">
      <div class="option-letter">D</div><div class="option-selected-check">‚úì</div>
      <div class="option-content">
        <div class="option-title">A genuinely international career</div>
        <div class="option-desc">I want to work across borders, live abroad, advise global clients</div>
      </div>
    </div>
  </div>
  <div class="q-nav">
    <button class="btn-back" onclick="prev(3)">‚Üê Back</button>
    <button class="btn-next" onclick="next(3)">Next ‚Üí</button>
  </div>
</div>

<!-- Q5: Personality -->
<div class="q-card" id="q4">
  <div class="q-number">Question 5 of 12 ‚Äî How Others See You</div>
  <div class="q-text">Which description fits you best in a group setting?</div>
  <div class="q-sub">Think about how colleagues or teammates would actually describe you.</div>
  <div class="options-grid" id="a4">
    <div class="option" onclick="selectOption('a4', this, 'analytical_quiet')">
      <div class="option-letter">A</div><div class="option-selected-check">‚úì</div>
      <div class="option-content">
        <div class="option-title">The one who's done the most preparation</div>
        <div class="option-desc">Quiet, precise, always has the detail others missed</div>
      </div>
    </div>
    <div class="option" onclick="selectOption('a4', this, 'connector_diplomat')">
      <div class="option-letter">B</div><div class="option-selected-check">‚úì</div>
      <div class="option-content">
        <div class="option-title">The one who brings people together</div>
        <div class="option-desc">Good at reading the room, finding consensus, managing relationships</div>
      </div>
    </div>
    <div class="option" onclick="selectOption('a4', this, 'challenger_debater')">
      <div class="option-letter">C</div><div class="option-selected-check">‚úì</div>
      <div class="option-content">
        <div class="option-title">The one who challenges assumptions</div>
        <div class="option-desc">Asks difficult questions, pushes for better answers, intellectually combative</div>
      </div>
    </div>
    <div class="option" onclick="selectOption('a4', this, 'driver_executor')">
      <div class="option-letter">D</div><div class="option-selected-check">‚úì</div>
      <div class="option-content">
        <div class="option-title">The one who gets things done</div>
        <div class="option-desc">Decisive, action-oriented, moves fast and drives projects forward</div>
      </div>
    </div>
  </div>
  <div class="q-nav">
    <button class="btn-back" onclick="prev(4)">‚Üê Back</button>
    <button class="btn-next" onclick="next(4)">Next ‚Üí</button>
  </div>
</div>

<!-- Q6: Geography spectrum -->
<div class="q-card" id="q5">
  <div class="q-number">Question 6 of 12 ‚Äî Geography</div>
  <div class="q-text">Where do you want your career to take you?</div>
  <div class="q-sub">Drag to where you sit on this spectrum.</div>
  <div class="spectrum">
    <div class="spectrum-labels">
      <span>Deep UK focus ‚Äî I want to be the best London corporate lawyer</span>
      <span>Fully global ‚Äî I want to live and work across multiple continents</span>
    </div>
    <input type="range" min="1" max="10" value="5" id="a5"
      oninput="updateSpectrum('a5', this.value, ['UK-focused','Strong UK base with international exposure','Balanced UK/international','Predominantly international','Truly global career'])">
    <div class="spectrum-value" id="a5-label">Balanced UK / international</div>
  </div>
  <div class="q-nav">
    <button class="btn-back" onclick="prev(5)">‚Üê Back</button>
    <button class="btn-next" onclick="next(5)">Next ‚Üí</button>
  </div>
</div>

<!-- Q7: Firm size feel -->
<div class="q-card" id="q6">
  <div class="q-number">Question 7 of 12 ‚Äî Environment</div>
  <div class="q-text">You're a trainee. Which scenario energises you more?</div>
  <div class="q-sub">Both are real Magic Circle trainee experiences.</div>
  <div class="options-grid" id="a6">
    <div class="option" onclick="selectOption('a6', this, 'small_responsibility')">
      <div class="option-letter">A</div><div class="option-selected-check">‚úì</div>
      <div class="option-content">
        <div class="option-title">You're one of 85 trainees</div>
        <div class="option-desc">You know almost everyone. Partners know your name. You're handed real responsibility early. The firm feels like a tight community.</div>
      </div>
    </div>
    <div class="option" onclick="selectOption('a6', this, 'large_exposure')">
      <div class="option-letter">B</div><div class="option-selected-check">‚úì</div>
      <div class="option-content">
        <div class="option-title">You're one of 120 trainees</div>
        <div class="option-desc">There's a huge network of peers. Secondment opportunities are endless. The deal flow is constant and the brand is unmatched globally.</div>
      </div>
    </div>
  </div>
  <div class="q-nav">
    <button class="btn-back" onclick="prev(6)">‚Üê Back</button>
    <button class="btn-next" onclick="next(6)">Next ‚Üí</button>
  </div>
</div>

<!-- Q8: Long-term -->
<div class="q-card" id="q7">
  <div class="q-number">Question 8 of 12 ‚Äî Long-term Ambition</div>
  <div class="q-text">Ten years from now, which version of yourself sounds most like you?</div>
  <div class="q-sub">Pick the one that genuinely resonates ‚Äî not the most impressive-sounding.</div>
  <div class="options-grid" id="a7">
    <div class="option" onclick="selectOption('a7', this, 'mc_partner')">
      <div class="option-letter">A</div><div class="option-selected-check">‚úì</div>
      <div class="option-content">
        <div class="option-title">Partner at a Magic Circle firm</div>
        <div class="option-desc">Running your own client relationships, building a practice, at the top of the legal profession</div>
      </div>
    </div>
    <div class="option" onclick="selectOption('a7', this, 'inhouse_gcl')">
      <div class="option-letter">B</div><div class="option-selected-check">‚úì</div>
      <div class="option-content">
        <div class="option-title">General Counsel at a major company</div>
        <div class="option-desc">Leading legal strategy from the inside, closer to business decisions, better work-life balance</div>
      </div>
    </div>
    <div class="option" onclick="selectOption('a7', this, 'us_firm_move')">
      <div class="option-letter">C</div><div class="option-selected-check">‚úì</div>
      <div class="option-content">
        <div class="option-title">Moved to a US firm for elite pay</div>
        <div class="option-desc">Using MC training as a launchpad to Kirkland, Latham or Skadden's London office</div>
      </div>
    </div>
    <div class="option" onclick="selectOption('a7', this, 'own_venture')">
      <div class="option-letter">D</div><div class="option-selected-check">‚úì</div>
      <div class="option-content">
        <div class="option-title">Built something of your own</div>
        <div class="option-desc">Launched a business, advisory firm, or moved into policy/government using your legal foundation</div>
      </div>
    </div>
  </div>
  <div class="q-nav">
    <button class="btn-back" onclick="prev(7)">‚Üê Back</button>
    <button class="btn-next" onclick="next(7)">Next ‚Üí</button>
  </div>
</div>

<!-- Q9: Values dilemma -->
<div class="q-card" id="q8">
  <div class="q-number">Question 9 of 12 ‚Äî Values</div>
  <div class="q-text">Your firm is advising a large oil company on a controversial acquisition. The deal is legal and profitable. How do you feel about it?</div>
  <div class="q-sub">Honest answers only ‚Äî this reveals what firms and culture fit you, not whether you're a good person.</div>
  <div class="options-grid single-col" id="a8">
    <div class="option" onclick="selectOption('a8', this, 'fully_commercial')">
      <div class="option-letter">A</div><div class="option-selected-check">‚úì</div>
      <div class="option-content">
        <div class="option-title">Fine with it ‚Äî that's commercial law</div>
        <div class="option-desc">My job is to give the best legal advice, not to judge the client's business decisions.</div>
      </div>
    </div>
    <div class="option" onclick="selectOption('a8', this, 'pragmatic_balance')">
      <div class="option-letter">B</div><div class="option-selected-check">‚úì</div>
      <div class="option-content">
        <div class="option-title">Fine as long as the firm balances it with pro bono</div>
        <div class="option-desc">Commercial work funds the pro bono work I care about ‚Äî I can live with the trade-off.</div>
      </div>
    </div>
    <div class="option" onclick="selectOption('a8', this, 'esg_conscious')">
      <div class="option-letter">C</div><div class="option-selected-check">‚úì</div>
      <div class="option-content">
        <div class="option-title">Uncomfortable ‚Äî I'd want to work on ESG deals instead</div>
        <div class="option-desc">I want a firm that actively prioritises sustainable finance and ESG-led transactions.</div>
      </div>
    </div>
    <div class="option" onclick="selectOption('a8', this, 'depends_on_client')">
      <div class="option-letter">D</div><div class="option-selected-check">‚úì</div>
      <div class="option-content">
        <div class="option-title">It depends ‚Äî I'd want to know who the client is</div>
        <div class="option-desc">I'd assess it case by case. I have limits but I'm not absolutist about it.</div>
      </div>
    </div>
  </div>
  <div class="q-nav">
    <button class="btn-back" onclick="prev(8)">‚Üê Back</button>
    <button class="btn-next" onclick="next(8)">Next ‚Üí</button>
  </div>
</div>

<!-- Q10: Hobbies/background ‚Äî personality signal -->
<div class="q-card" id="q9">
  <div class="q-number">Question 10 of 12 ‚Äî You Outside Law</div>
  <div class="q-text">What do you do when you're not studying? What are you genuinely good at outside of academia?</div>
  <div class="q-sub">Hobbies and personality reveal more about firm fit than you'd think. Be specific ‚Äî "chess" tells us more than "socialising".</div>
  <textarea class="q-input" id="a9" placeholder="e.g. I play competitive chess and follow financial markets obsessively. I also coach junior football on weekends ‚Äî I find the leadership side rewarding. I'm learning Arabic..."></textarea>
  <div class="q-nav">
    <button class="btn-back" onclick="prev(9)">‚Üê Back</button>
    <button class="btn-next" onclick="next(9)">Next ‚Üí</button>
  </div>
</div>

<!-- Q11: Specific sector tags -->
<div class="q-card" id="q10">
  <div class="q-number">Question 11 of 12 ‚Äî Sectors</div>
  <div class="q-text">Which sectors genuinely interest you? Select all that apply.</div>
  <div class="q-sub">Think about which industries you read about for pleasure, not just which ones sound impressive.</div>
  <div class="tag-grid" id="a10">
    <div class="tag-select" onclick="toggleTag(this)">Technology & AI</div>
    <div class="tag-select" onclick="toggleTag(this)">Financial Services</div>
    <div class="tag-select" onclick="toggleTag(this)">Healthcare & Pharma</div>
    <div class="tag-select" onclick="toggleTag(this)">Energy & Climate</div>
    <div class="tag-select" onclick="toggleTag(this)">Private Equity</div>
    <div class="tag-select" onclick="toggleTag(this)">Sovereign & Government</div>
    <div class="tag-select" onclick="toggleTag(this)">Infrastructure</div>
    <div class="tag-select" onclick="toggleTag(this)">Media & Entertainment</div>
    <div class="tag-select" onclick="toggleTag(this)">Defence & Security</div>
    <div class="tag-select" onclick="toggleTag(this)">Real Estate</div>
    <div class="tag-select" onclick="toggleTag(this)">Emerging Markets</div>
    <div class="tag-select" onclick="toggleTag(this)">Consumer & Retail</div>
  </div>
  <div class="q-nav">
    <button class="btn-back" onclick="prev(10)">‚Üê Back</button>
    <button class="btn-next" onclick="next(10)">Next ‚Üí</button>
  </div>
</div>

<!-- Q12: Open -->
<div class="q-card" id="q11">
  <div class="q-number">Question 12 of 12 ‚Äî Anything Else</div>
  <div class="q-text">Is there anything about you that doesn't fit neatly into the questions above?</div>
  <div class="q-sub">First-generation student, international background, specific experience, strong view on one firm ‚Äî anything that might be relevant to your match. Optional but often the most useful input.</div>
  <textarea class="q-input" id="a11" placeholder="e.g. I'm originally from Turkey and want to work on deals involving the Middle East or Central Asia. I did a year working at a startup before university. I have a specific interest in Slaughter and May's model but I'm not sure if I'd fit..."></textarea>
  <div class="q-nav">
    <button class="btn-back" onclick="prev(11)">‚Üê Back</button>
    <button class="btn-match" id="matchBtn" onclick="runMatch()">‚ö° Find My Firm</button>
  </div>
</div>

<!-- LOADING -->
<div class="loading-screen" id="loadingScreen">
  <div class="spinner"></div>
  <div class="loading-title">Analysing your profile...</div>
  <div class="loading-sub">Searching real cases, matching firm cultures, building your report</div>
  <div class="loading-steps">
    <div class="lstep" id="ls0"><div class="lstep-dot"></div>Reading your profile</div>
    <div class="lstep" id="ls1"><div class="lstep-dot"></div>Matching to firm cultures & values</div>
    <div class="lstep" id="ls2"><div class="lstep-dot"></div>Searching recent real cases online</div>
    <div class="lstep" id="ls3"><div class="lstep-dot"></div>Aligning cases to your interests</div>
    <div class="lstep" id="ls4"><div class="lstep-dot"></div>Writing your personalised report</div>
  </div>
</div>

<!-- RESULTS -->
<div class="results-screen" id="resultsScreen"></div>

</div><!-- /page -->
<div id="footer-shell"></div>

<script src="site.js"></script>
<script>
document.getElementById('shell').innerHTML = SITE.nav('match');
document.getElementById('footer-shell').innerHTML = SITE.footer();
SITE.initDate();

const TOTAL_Q = 12;
let currentQ = 0;
const answers = {};

const spectrumLabels = {
  a5: ['UK-focused','UK base with some international','Balanced UK/international','Predominantly international','Truly global career']
};

function updateSpectrum(id, val, labels) {
  const idx = Math.round((val - 1) / 9 * (labels.length - 1));
  document.getElementById(id + '-label').textContent = labels[idx];
  answers[id] = labels[idx];
}

function selectOption(groupId, el, val) {
  document.querySelectorAll('#' + groupId + ' .option').forEach(o => o.classList.remove('selected'));
  el.classList.add('selected');
  answers[groupId] = val + ': ' + el.querySelector('.option-title').textContent;
}

function toggleTag(el) {
  el.classList.toggle('selected');
}

function getTagsSelected(groupId) {
  return [...document.querySelectorAll('#' + groupId + ' .tag-select.selected')].map(t => t.textContent).join(', ') || 'None selected';
}

function updateProgress(q) {
  const pct = Math.round(((q + 1) / TOTAL_Q) * 100);
  document.getElementById('progressFill').style.width = pct + '%';
  document.getElementById('progressNum').textContent = (q + 1) + ' / ' + TOTAL_Q;
}

function next(q) {
  // Collect input-type answers
  const inputEl = document.getElementById('a' + q);
  if (inputEl && (inputEl.tagName === 'INPUT' || inputEl.tagName === 'TEXTAREA')) {
    answers['a' + q] = inputEl.value.trim() || '(not provided)';
  }
  // Collect tag groups
  if (q === 10) answers['a10'] = getTagsSelected('a10');
  if (q === 5) answers['a5'] = document.getElementById('a5').value;

  document.getElementById('q' + q).classList.remove('active');
  currentQ = q + 1;
  document.getElementById('q' + currentQ).classList.add('active');
  updateProgress(currentQ);
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

function prev(q) {
  document.getElementById('q' + q).classList.remove('active');
  currentQ = q - 1;
  document.getElementById('q' + currentQ).classList.add('active');
  updateProgress(currentQ);
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

function animateLoading() {
  const steps = ['ls0','ls1','ls2','ls3','ls4'];
  let i = 0;
  function tick() {
    if (i > 0) { document.getElementById(steps[i-1]).classList.remove('active'); document.getElementById(steps[i-1]).classList.add('done'); }
    if (i < steps.length) { document.getElementById(steps[i]).classList.add('active'); i++; setTimeout(tick, 1100); }
  }
  tick();
}

async function runMatch() {
  // Collect final answers
  answers['a11'] = document.getElementById('a11').value.trim() || '(not provided)';
  document.getElementById('matchBtn').disabled = true;
  document.querySelectorAll('.q-card').forEach(c => c.style.display = 'none');
  document.getElementById('progressBar').style.display = 'none';
  document.getElementById('loadingScreen').style.display = 'block';
  animateLoading();
  window.scrollTo({ top: 0, behavior: 'smooth' });

  // Build the profile summary
  const profile = `
STUDENT PROFILE FOR MAGIC CIRCLE FIRM MATCHING:

1. Education & background: ${answers['a0'] || 'not provided'}
2. Under pressure thinking style: ${answers['a1'] || 'not provided'}
3. Most interesting headline (reveals practice interest): ${answers['a2'] || 'not provided'}
4. Career priority trade-off: ${answers['a3'] || 'not provided'}
5. Personality in groups: ${answers['a4'] || 'not provided'}
6. Geography preference (1=UK only, 10=fully global): ${answers['a5'] || '5'}
7. Firm size preference: ${answers['a6'] || 'not provided'}
8. 10-year ambition: ${answers['a7'] || 'not provided'}
9. Values ‚Äî approach to controversial client work: ${answers['a8'] || 'not provided'}
10. Hobbies and personality outside law: ${answers['a9'] || 'not provided'}
11. Sectors of genuine interest: ${answers['a10'] || 'not provided'}
12. Additional context: ${answers['a11'] || 'not provided'}
`;

  // STEP 1: Get firm match analysis
  const matchPrompt = `You are a senior Magic Circle careers advisor. A student has completed a detailed psychological and preference profiling questionnaire. Analyse their profile and match them to the best Magic Circle firm.

${profile}

THE FIVE FIRMS AND THEIR GENUINE DIFFERENTIATORS:
- A&O Shearman: Largest MC firm post-merger (3,900 lawyers). Strongest in banking/finance and leveraged finance. Growing US PE practice. Post-merger integration still ongoing. Very formal culture. Best for: finance-oriented, global ambition, comfortable with scale and change.
- Clifford Chance: Most genuinely global MC firm. Strong capital markets, PE, disputes and fintech. Growing US PE. Launched CC Advance (legaltech). International/open culture. Best for: genuinely international, tech-interested, adaptable personality.
- Freshfields: Record 2025 revenues. US expansion paying off ‚Äî top 5 global M&A adviser. Elite in M&A, competition/antitrust and disputes. Intellectual, driven, slightly intense culture. Best for: analytically rigorous, M&A/antitrust focused, ambitious, comfortable with high pressure.
- Linklaters: Elite in debt capital markets and emerging markets. 34 new partners in 2025 ‚Äî most in MC. Fastest US revenue growth. Collaborative culture. Best for: capital markets interest, emerging markets, collaborative personality, steady growth ambition.
- Slaughter and May: Deliberately small (~500 lawyers). No billing targets. Best friend network model. Deepest UK M&A expertise. Collegiate, relaxed, meritocratic culture. Best for: quality over scale, UK-focused, independent thinkers, values culture over brand.

Return ONLY valid JSON:
{
  "top_firm": "exact firm name",
  "top_pct": number 60-95,
  "top_tagline": "one compelling sentence why this firm fits them personally ‚Äî reference something specific from their answers",
  "why_fit": "3-4 sentences of genuine insight ‚Äî connect specific things they said to specific firm characteristics. Make them feel seen.",
  "personality_insight": "2 sentences on what their answers reveal about their character and how that maps to this firm's culture",
  "watch_out": "one honest concern or thing to be aware of ‚Äî what might be hard for them at this firm",
  "cover_letter_angle": "one specific, concrete opening angle for their cover letter ‚Äî something unique about them + something specific about the firm's current strategy right now",
  "scores": {
    "A&O Shearman": number,
    "Clifford Chance": number,
    "Freshfields": number,
    "Linklaters": number,
    "Slaughter and May": number
  },
  "dimensions": {
    "Practice area fit": number,
    "Culture match": number,
    "Geographic alignment": number,
    "Career trajectory": number,
    "Values alignment": number
  },
  "second_firm": "second best firm",
  "second_reason": "one sentence",
  "case_search_query": "a specific Google search query to find 2-3 real recent cases or deals this firm worked on that would interest THIS specific student based on their profile ‚Äî be specific e.g. 'Freshfields antitrust technology merger 2024 2025' or 'Linklaters emerging markets sovereign bond 2025'"
}`;

  try {
    const matchRes = await fetch('/api/ai', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ prompt: matchPrompt, useSearch: false })
    });
    const matchData = await matchRes.json();
    const matchText = matchData.text.replace(/```json|```/g, '').trim();
    const match = JSON.parse(matchText);

    // STEP 2: Search for real cases
    const casePrompt = `Search the web and find 3 real, specific, recent (2023-2026) legal cases, deals or mandates that ${match.top_firm} worked on.

The student's interests are: ${answers['a2']} and sectors: ${answers['a10']}.

For each case/deal found, provide:
- The real name or description of the deal/case
- What ${match.top_firm}'s role was
- Why this specific student (interested in ${answers['a2']} and ${answers['a10']}) would find it interesting
- A source URL if available

Format as a clear list. Be specific ‚Äî use real deal names, real company names, real dates. Do not invent cases.`;

    const caseRes = await fetch('/api/ai', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ prompt: casePrompt, useSearch: true })
    });
    const caseData = await caseRes.json();

    document.getElementById('loadingScreen').style.display = 'none';
    renderResults(match, caseData.text, caseData.sources || []);

  } catch(err) {
    document.getElementById('loadingScreen').style.display = 'none';
    document.getElementById('resultsScreen').style.display = 'block';
    document.getElementById('resultsScreen').innerHTML = `
      <div style="background:var(--white);border:1px solid var(--border);padding:40px;text-align:center;">
        <div style="font-size:28px;margin-bottom:12px;">‚ö†Ô∏è</div>
        <div style="font-family:'Frank Ruhl Libre',serif;font-size:20px;font-weight:700;margin-bottom:8px;">Something went wrong</div>
        <div style="font-size:13px;color:var(--muted);margin-bottom:20px;">Error: ${err.message}<br><br>Make sure the site is deployed on Netlify with the API key configured.</div>
        <button onclick="location.reload()" style="padding:10px 24px;background:var(--ink);color:white;border:none;font-family:'DM Sans',sans-serif;font-size:13px;cursor:pointer;">Try Again</button>
      </div>`;
  }
}

const firmColors = {
  'A&O Shearman':'var(--ao)',
  'Clifford Chance':'var(--cc)',
  'Freshfields':'var(--fresh)',
  'Linklaters':'var(--link)',
  'Slaughter and May':'var(--slaughter)'
};
const firmSlugs = {
  'A&O Shearman':'ao','Clifford Chance':'cc',
  'Freshfields':'fresh','Linklaters':'link','Slaughter and May':'slaughter'
};

function renderResults(match, casesText, sources) {
  const col = firmColors[match.top_firm] || 'var(--ink)';
  const slug = firmSlugs[match.top_firm] || '';

  const otherFirms = Object.entries(match.scores || {})
    .filter(([n]) => n !== match.top_firm)
    .sort((a,b) => b[1]-a[1]);

  const dimBars = Object.entries(match.dimensions || {}).map(([dim, val]) => `
    <div class="dim-row">
      <span class="dim-label">${dim}</span>
      <div class="dim-track"><div class="dim-fill" style="background:${col}" data-w="${val}"></div></div>
      <span class="dim-val" style="color:${col}">${val}</span>
    </div>`).join('');

  const otherRows = otherFirms.map(([name, pct]) => `
    <div class="other-row" onclick="window.location='firms.html#${firmSlugs[name]||''}'">
      <div class="other-dot" style="background:${firmColors[name]||'#999'}"></div>
      <span class="other-name">${name}</span>
      <div class="other-track"><div class="other-fill" style="width:${pct}%;background:${firmColors[name]||'#999'}"></div></div>
      <span class="other-pct" style="color:${firmColors[name]||'#999'}">${pct}%</span>
    </div>`).join('');

  const sourcesHtml = sources.length ? `
    <div class="sources-box">
      <strong>Sources searched:</strong> ${sources.slice(0,4).map(s =>
        `<a href="${s.url}" target="_blank">${s.title}</a>`).join(' ¬∑ ')}
    </div>` : '';

  document.getElementById('resultsScreen').innerHTML = `

    <!-- HERO -->
    <div class="result-hero" style="background:${col};">
      <div class="result-hero-left">
        <div class="result-badge">üèÜ Your Best Match</div>
        <div class="result-firm-name">${match.top_firm}</div>
        <div class="result-tagline">${match.top_tagline || ''}</div>
      </div>
      <div class="result-score-circle">
        <div class="result-score-num">${match.top_pct}%</div>
        <div class="result-score-label">MATCH SCORE</div>
      </div>
    </div>

    <div class="result-grid">

      <div class="result-box full">
        <div class="result-box-title">üéØ Why This Firm Fits You</div>
        <div class="result-text">${match.why_fit || ''}</div>
      </div>

      <div class="result-box">
        <div class="result-box-title">üß† What Your Answers Say About You</div>
        <div class="result-text">${match.personality_insight || ''}</div>
      </div>

      <div class="result-box">
        <div class="result-box-title">üìä Match Breakdown</div>
        ${dimBars}
      </div>

      <div class="result-box full">
        <div class="result-box-title">üíº Real Cases at ${match.top_firm} That Align With Your Interests</div>
        <div class="result-text">${casesText.replace(/\n/g, '<br>') || 'Loading cases...'}</div>
        ${sourcesHtml}
      </div>

      <div class="result-box full">
        <div class="result-box-title">‚úçÔ∏è Your Cover Letter Opening Angle</div>
        <div class="cover-letter-box">${match.cover_letter_angle || ''}</div>
      </div>

      <div class="result-box full">
        <div class="result-box-title">üí° One Thing to Consider</div>
        <div class="result-text">${match.watch_out || ''}</div>
      </div>

    </div>

    <!-- OTHER FIRMS -->
    <div class="section-head" style="margin-top:24px;"><h2>How You Match All Five Firms</h2></div>
    <div style="font-size:12px;color:var(--muted);margin-bottom:8px;">Click any firm to read their full profile</div>
    <div class="other-list">${otherRows}</div>
    ${match.second_firm ? `<div style="padding:14px 16px;background:var(--white);border:1px solid var(--border);font-size:13.5px;color:#333;margin-bottom:4px;"><strong>Also worth considering:</strong> ${match.second_firm} ‚Äî ${match.second_reason}</div>` : ''}

    <div class="action-row">
      <a href="firms.html#${slug}" class="btn-action btn-primary-action">View ${match.top_firm} Profile ‚Üí</a>
      <a href="interview.html" class="btn-action btn-primary-action" style="background:var(--ink)">Prepare for Interview ‚Üí</a>
      <button onclick="location.reload()" class="btn-action btn-ghost-action">Start Again</button>
    </div>

    <div style="margin-top:20px;padding:14px 18px;background:var(--faint);border:1px solid var(--border);font-size:11.5px;color:var(--muted);">
      Match generated by MagicCircleHub AI using Google Gemini with live web search. For educational purposes ‚Äî always do your own research and speak to current trainees before applying.
    </div>
  `;

  document.getElementById('resultsScreen').style.display = 'block';
  window.scrollTo({ top: 0, behavior: 'smooth' });

  setTimeout(() => {
    document.querySelectorAll('.dim-fill[data-w]').forEach(b => {
      b.style.width = b.getAttribute('data-w') + '%';
    });
  }, 200);
}
</script>
</body>
</html>
